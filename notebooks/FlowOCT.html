<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Fair Optimal Classification Trees" href="FairOCT.html" /><link rel="prev" title="Example Notebooks" href="index.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>FlowOCT Examples - odtlearn 0.1.dev1+g202a813 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">odtlearn 0.1.dev1+g202a813 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/img/ODTlearn-color.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/img/ODTlearn-color.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">odtlearn 0.1.dev1+g202a813 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user_guide/index.html">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/optimal_classification_trees.html">Optimal Classification Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/fair_optimal_classification_trees.html">Fair Optimal Classification Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/optimal_robust_classification_trees.html">Robust Optimal Classification Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/optimal_prescriptive_trees.html">Optimal Prescriptive Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/adding_constraints.html">Adding side constraints to optimal classification trees</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">ODTlearn API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of ODTlearn API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/odtlearn/index.html">odtlearn</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of odtlearn</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/odtlearn/utils/index.html">odtlearn.utils</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of odtlearn.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/odtlearn/utils/Tree/index.html">odtlearn.utils.Tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/odtlearn/utils/TreePlotter/index.html">odtlearn.utils.TreePlotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/odtlearn/utils/binarize/index.html">odtlearn.utils.binarize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/odtlearn/utils/callback_helpers/index.html">odtlearn.utils.callback_helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/odtlearn/utils/callbacks/index.html">odtlearn.utils.callbacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/odtlearn/utils/solver/index.html">odtlearn.utils.solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/odtlearn/utils/validation/index.html">odtlearn.utils.validation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/constrained_oct/index.html">odtlearn.constrained_oct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/datasets/index.html">odtlearn.datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/fair_oct/index.html">odtlearn.fair_oct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/flow_oct/index.html">odtlearn.flow_oct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/flow_oct_ms/index.html">odtlearn.flow_oct_ms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/flow_oct_ss/index.html">odtlearn.flow_oct_ss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/flow_opt/index.html">odtlearn.flow_opt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/flow_opt_ms/index.html">odtlearn.flow_opt_ms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/flow_opt_ss/index.html">odtlearn.flow_opt_ss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/opt_ct/index.html">odtlearn.opt_ct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/opt_dt/index.html">odtlearn.opt_dt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/opt_pt/index.html">odtlearn.opt_pt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/odtlearn/robust_oct/index.html">odtlearn.robust_oct</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notebooks</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Example Notebooks</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Example Notebooks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">FlowOCT</span></code> Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="FairOCT.html">Fair Optimal Classification Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="RobustOCT.html"><code class="docutils literal notranslate"><span class="pre">RobustOCT</span></code> Examples</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">How to contribute to ODTlearn</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/notebooks/FlowOCT.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

from odtlearn.flow_oct import FlowOCT, BendersOCT
from odtlearn.utils.binarize import Binarizer
</pre></div>
</div>
</div>
<section id="FlowOCT-Examples">
<h1><code class="docutils literal notranslate"><span class="pre">FlowOCT</span></code> Examples<a class="headerlink" href="#FlowOCT-Examples" title="Link to this heading">¶</a></h1>
<section id="Example-0:-Binarization">
<h2>Example 0: Binarization<a class="headerlink" href="#Example-0:-Binarization" title="Link to this heading">¶</a></h2>
<p>The following example shows how to binarize a dataset with categorical, integer, and continuous features using the built-in <code class="docutils literal notranslate"><span class="pre">Binarizer</span></code> class. This class follows the scikit-learn fit-transform paradigm, making it easy to integrate into your preprocessing pipeline.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>number_of_child_list = [1, 2, 4, 3, 1, 2, 4, 3, 2, 1]
age_list = [10, 20, 40, 30, 10, 20, 40, 30, 20, 10]
race_list = [
    &quot;Black&quot;,
    &quot;White&quot;,
    &quot;Hispanic&quot;,
    &quot;Black&quot;,
    &quot;White&quot;,
    &quot;Black&quot;,
    &quot;White&quot;,
    &quot;Hispanic&quot;,
    &quot;Black&quot;,
    &quot;White&quot;,
]
sex_list = [&quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;]
income_list = [50000, 75000, 100000, 60000, 80000, 55000, 90000, 70000, 85000, 65000]

df = pd.DataFrame(
    list(zip(sex_list, race_list, number_of_child_list, age_list, income_list)),
    columns=[&quot;sex&quot;, &quot;race&quot;, &quot;num_child&quot;, &quot;age&quot;, &quot;income&quot;],
)

print(df)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
  sex      race  num_child  age  income
0   M     Black          1   10   50000
1   F     White          2   20   75000
2   M  Hispanic          4   40  100000
3   M     Black          3   30   60000
4   F     White          1   10   80000
5   M     Black          2   20   55000
6   F     White          4   40   90000
7   M  Hispanic          3   30   70000
8   M     Black          2   20   85000
9   F     White          1   10   65000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>binarizer = Binarizer(
    categorical_cols=[&quot;sex&quot;, &quot;race&quot;],
    integer_cols=[&quot;num_child&quot;, &quot;age&quot;],
    real_cols=[&quot;income&quot;],
    n_bins=5  # Number of bins for continuous features
)

# Fit and transform the data
df_enc = binarizer.fit_transform(df)

print(df_enc)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   sex_M  race_Black  race_Hispanic  race_White  num_child_1  num_child_2  \
0    1.0         1.0            0.0         0.0          1.0          1.0
1    0.0         0.0            0.0         1.0          0.0          1.0
2    1.0         0.0            1.0         0.0          0.0          0.0
3    1.0         1.0            0.0         0.0          0.0          0.0
4    0.0         0.0            0.0         1.0          1.0          1.0
5    1.0         1.0            0.0         0.0          0.0          1.0
6    0.0         0.0            0.0         1.0          0.0          0.0
7    1.0         0.0            1.0         0.0          0.0          0.0
8    1.0         1.0            0.0         0.0          0.0          1.0
9    0.0         0.0            0.0         1.0          1.0          1.0

   num_child_3  num_child_4  age_10  age_20  age_30  age_40  income_0  \
0          1.0          1.0     1.0     1.0     1.0     1.0       1.0
1          1.0          1.0     0.0     1.0     1.0     1.0       0.0
2          0.0          1.0     0.0     0.0     0.0     1.0       0.0
3          1.0          1.0     0.0     0.0     1.0     1.0       0.0
4          1.0          1.0     1.0     1.0     1.0     1.0       0.0
5          1.0          1.0     0.0     1.0     1.0     1.0       1.0
6          0.0          1.0     0.0     0.0     0.0     1.0       0.0
7          1.0          1.0     0.0     0.0     1.0     1.0       0.0
8          1.0          1.0     0.0     1.0     1.0     1.0       0.0
9          1.0          1.0     1.0     1.0     1.0     1.0       0.0

   income_1  income_2  income_3  income_4
0       1.0       1.0       1.0       1.0
1       0.0       1.0       1.0       1.0
2       0.0       0.0       0.0       1.0
3       1.0       1.0       1.0       1.0
4       0.0       0.0       1.0       1.0
5       1.0       1.0       1.0       1.0
6       0.0       0.0       0.0       1.0
7       0.0       1.0       1.0       1.0
8       0.0       0.0       1.0       1.0
9       1.0       1.0       1.0       1.0
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Binarizer</span></code> class follows the scikit-learn fit-transform paradigm:</p>
<p>We initialize the <code class="docutils literal notranslate"><span class="pre">Binarizer</span></code> with our desired parameters, specifying which columns are categorical, integer, and real-valued. We call the fit_transform method, which first fits the binarizer to our data (learning the necessary encoding schemes) and then transforms the data using those learned encodings.</p>
<p>The resulting <code class="docutils literal notranslate"><span class="pre">df_enc</span></code> DataFrame contains the binarized version of our original data:</p>
<p>Categorical columns (sex, race) are one-hot encoded. Integer columns (num_child, age) are binary encoded, where each column represents “greater than or equal to” a certain value. The continuous column (income) is first discretized into 5 bins, then binary encoded similar to the integer columns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(df_enc.columns)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;sex_M&#39;, &#39;race_Black&#39;, &#39;race_Hispanic&#39;, &#39;race_White&#39;, &#39;num_child_1&#39;,
       &#39;num_child_2&#39;, &#39;num_child_3&#39;, &#39;num_child_4&#39;, &#39;age_10&#39;, &#39;age_20&#39;,
       &#39;age_30&#39;, &#39;age_40&#39;, &#39;income_0&#39;, &#39;income_1&#39;, &#39;income_2&#39;, &#39;income_3&#39;,
       &#39;income_4&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<p>This binarized data is now ready to be used with any of the models in ODTlearn, which require binary input features. If you need to transform new data using the same encoding scheme, you can use the transform method of the fitted binarizer:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new_data = pd.DataFrame({
    &quot;sex&quot;: [&quot;F&quot;, &quot;M&quot;],
    &quot;race&quot;: [&quot;Hispanic&quot;, &quot;White&quot;],
    &quot;num_child&quot;: [2, 3],
    &quot;age&quot;: [20, 30],
    &quot;income&quot;: [70000, 80000]
})

new_data_enc = binarizer.transform(new_data)
print(new_data_enc)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   sex_M  race_Black  race_Hispanic  race_White  num_child_1  num_child_2  \
0    0.0         0.0            1.0         0.0          0.0          1.0
1    1.0         0.0            0.0         1.0          0.0          0.0

   num_child_3  num_child_4  age_10  age_20  age_30  age_40  income_0  \
0          1.0          1.0     0.0     1.0     1.0     1.0         0
1          1.0          1.0     0.0     0.0     1.0     1.0         0

   income_1  income_2  income_3  income_4
0         0       1.0       1.0         0
1         0       0.0       1.0         0
</pre></div></div>
</div>
<p>Note that for categorical features, if the new data contains categories not seen during fitting, the transform method will raise an error. In such cases, you might need to refit the binarizer on a dataset that includes all possible categories.</p>
</section>
<section id="Example-1:-Varying-depth-and-_lambda">
<h2>Example 1: Varying <code class="docutils literal notranslate"><span class="pre">depth</span></code> and <code class="docutils literal notranslate"><span class="pre">_lambda</span></code><a class="headerlink" href="#Example-1:-Varying-depth-and-_lambda" title="Link to this heading">¶</a></h2>
<p>In this part, we study a simple example and investigate different parameter combinations to provide intuition on how they affect the structure of the tree.</p>
<p>First we generate the data for our example. The diagram within the code block shows the training dataset. Our dataset has two binary features (X1 and X2) and two class labels (+1 and -1).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from odtlearn.datasets import flow_oct_example

&quot;&quot;&quot;
    X2
    |               |
    |               |
    1    + +        |    -
    |               |
    |---------------|-------------
    |               |
    0    - - - -    |    + + +
    |    - - -      |
    |______0________|_______1_______X1
&quot;&quot;&quot;


X, y = flow_oct_example()
</pre></div>
</div>
</div>
<section id="Tree-with-depth-=-1">
<h3>Tree with <code class="docutils literal notranslate"><span class="pre">depth</span> <span class="pre">=</span> <span class="pre">1</span></code><a class="headerlink" href="#Tree-with-depth-=-1" title="Link to this heading">¶</a></h3>
<p>In the following, we fit a classification tree of depth 1, i.e., a tree with a single branching node and two leaf nodes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl = FlowOCT(depth=1, solver=&quot;gurobi&quot;, time_limit=100)
stcl.store_search_progress_log = True
stcl.fit(X, y)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 100
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 110 rows, 89 columns and 250 nonzeros
Model fingerprint: 0x5e9209d1
Variable types: 84 continuous, 5 integer (5 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Presolve removed 102 rows and 82 columns
Presolve time: 0.00s
Presolved: 8 rows, 7 columns, 16 nonzeros
Variable types: 6 continuous, 1 integer (1 binary)
Found heuristic solution: objective 9.0000000

Root relaxation: objective 1.000000e+01, 2 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0      10.0000000   10.00000  0.00%     -    0s

Explored 1 nodes (2 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 8 (of 8 available processors)

Solution count 2: 10 9

Optimal solution found (tolerance 1.00e-04)
Best objective 1.000000000000e+01, best bound 1.000000000000e+01, gap 0.0000%

User-callback calls 573, time in user-callback 0.00 sec
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FlowOCT(solver=gurobi,depth=1,time_limit=100,num_threads=None,verbose=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>predictions = stcl.predict(X)
print(f&#39;Optimality gap is {stcl.optim_gap}&#39;)
print(f&quot;In-sample accuracy is {np.sum(predictions==y)/y.shape[0]}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimality gap is 0.0
In-sample accuracy is 0.7692307692307693
</pre></div></div>
</div>
<p>Users can access statistics from the optimization run such as optimality gap, number of nodes, number of constraints, etc. Directly as properties of the initialized class or through the <code class="docutils literal notranslate"><span class="pre">_solver</span></code> object. For example, one can access the optimality gap and the number of solutions after fitting the optimal decision tree through the <code class="docutils literal notranslate"><span class="pre">optim_gap</span></code> and <code class="docutils literal notranslate"><span class="pre">num_solutions</span></code> properties.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(f&#39;Optimality gap is {stcl.optim_gap}&#39;)
print(f&#39;Number of solutions {stcl.num_solutions}&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimality gap is 0.0
Number of solutions 2
</pre></div></div>
</div>
<p>As we can see above, we find the optimal tree and the in-sample accuracy is 76%.</p>
<p>ODTlearn provides two different ways of visualizing the structure of the tree. The first method prints the structure of the tree in the console:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl.print_tree()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#########node  1
branch on X_0
#########node  2
leaf 0
#########node  3
leaf 1
</pre></div></div>
</div>
<p>The second method plots the structure of the tree using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(5, 5))
stcl.plot_tree(ax=ax)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_20_0.png" src="../_images/notebooks_FlowOCT_20_0.png" />
</div>
</div>
<p>We also provide a simple function allowing users to plot the search progress log over time. Note that you must set the attribute <code class="docutils literal notranslate"><span class="pre">store_search_progress_log</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> before calling the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method to ensure that the bound information is stored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl_progress_log = FlowOCT(depth=1, solver=&quot;gurobi&quot;, time_limit=100)
stcl_progress_log.store_search_progress_log = True
stcl_progress_log.fit(X, y)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 100
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 110 rows, 89 columns and 250 nonzeros
Model fingerprint: 0x5e9209d1
Variable types: 84 continuous, 5 integer (5 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Presolve removed 102 rows and 82 columns
Presolve time: 0.00s
Presolved: 8 rows, 7 columns, 16 nonzeros
Variable types: 6 continuous, 1 integer (1 binary)
Found heuristic solution: objective 9.0000000

Root relaxation: objective 1.000000e+01, 2 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0      10.0000000   10.00000  0.00%     -    0s

Explored 1 nodes (2 simplex iterations) in 0.01 seconds (0.00 work units)
Thread count was 8 (of 8 available processors)

Solution count 2: 10 9

Optimal solution found (tolerance 1.00e-04)
Best objective 1.000000000000e+01, best bound 1.000000000000e+01, gap 0.0000%

User-callback calls 573, time in user-callback 0.00 sec
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FlowOCT(solver=gurobi,depth=1,time_limit=100,num_threads=None,verbose=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl.plot_search_progress()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:title={&#39;center&#39;:&#39;Search Progress&#39;}, xlabel=&#39;Time (s)&#39;, ylabel=&#39;Objective Bound&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_23_1.png" src="../_images/notebooks_FlowOCT_23_1.png" />
</div>
</div>
</section>
<section id="Tree-with-depth-=-2">
<h3>Tree with <code class="docutils literal notranslate"><span class="pre">depth</span> <span class="pre">=</span> <span class="pre">2</span></code><a class="headerlink" href="#Tree-with-depth-=-2" title="Link to this heading">¶</a></h3>
<p>Now we increase the depth of the tree to achieve higher accuracy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl = FlowOCT(depth=2, solver=&quot;gurobi&quot;)
stcl.fit(X, y)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 60
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 274 rows, 209 columns and 642 nonzeros
Model fingerprint: 0x51470803
Variable types: 196 continuous, 13 integer (13 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -0.0000000
Presolve removed 250 rows and 187 columns
Presolve time: 0.00s
Presolved: 24 rows, 22 columns, 76 nonzeros
Found heuristic solution: objective 8.0000000
Variable types: 16 continuous, 6 integer (6 binary)

Root relaxation: objective 1.300000e+01, 14 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0      13.0000000   13.00000  0.00%     -    0s

Explored 1 nodes (14 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 8 (of 8 available processors)

Solution count 3: 13 8 -0

Optimal solution found (tolerance 1.00e-04)
Best objective 1.300000000000e+01, best bound 1.300000000000e+01, gap 0.0000%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FlowOCT(solver=gurobi,depth=2,time_limit=60,num_threads=None,verbose=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>predictions = stcl.predict(X)
print(f&quot;In-sample accuracy is {np.sum(predictions==y)/y.shape[0]}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In-sample accuracy is 1.0
</pre></div></div>
</div>
<p>As we can see, with depth 2, we can achieve 100% in-sample accuracy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(10, 5))
stcl.plot_tree(ax=ax, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_28_0.png" src="../_images/notebooks_FlowOCT_28_0.png" />
</div>
</div>
</section>
<section id="Tree-with-depth=2-and-Positive-_lambda">
<h3>Tree with <code class="docutils literal notranslate"><span class="pre">depth=2</span></code> and Positive <code class="docutils literal notranslate"><span class="pre">_lambda</span></code><a class="headerlink" href="#Tree-with-depth=2-and-Positive-_lambda" title="Link to this heading">¶</a></h3>
<p>As we saw in the above example, with depth 2, we can fully classify the training data. However if we add a regularization term with a high enough value of <code class="docutils literal notranslate"><span class="pre">_lambda</span></code>, we can justify pruning one of the branching nodes to get a sparser tree. In the following, we observe that as we increase <code class="docutils literal notranslate"><span class="pre">_lambda</span></code> from 0 to 0.51, one of the branching nodes gets pruned and as a result, the in-sample accuracy drops to 92%.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl = FlowOCT(solver=&quot;gurobi&quot;, depth=2, _lambda=0.51)
stcl.fit(X, y)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 60
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 274 rows, 209 columns and 642 nonzeros
Model fingerprint: 0x3e3f455b
Variable types: 196 continuous, 13 integer (13 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [5e-01, 5e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -0.0000000
Presolve removed 250 rows and 187 columns
Presolve time: 0.00s
Presolved: 24 rows, 22 columns, 76 nonzeros
Found heuristic solution: objective 3.9200000
Variable types: 16 continuous, 6 integer (6 binary)

Root relaxation: objective 5.105000e+00, 14 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.10500    0    2    3.92000    5.10500  30.2%     -    0s
H    0     0                       4.8600000    5.10500  5.04%     -    0s

Explored 1 nodes (14 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 8 (of 8 available processors)

Solution count 3: 4.86 3.92 -0

Optimal solution found (tolerance 1.00e-04)
Best objective 4.860000000000e+00, best bound 4.860000000000e+00, gap 0.0000%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FlowOCT(solver=gurobi,depth=2,time_limit=60,num_threads=None,verbose=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>predictions = stcl.predict(X)
print(f&quot;In-sample accuracy is {np.sum(predictions==y)/y.shape[0]}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In-sample accuracy is 0.9230769230769231
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(10, 5))
stcl.plot_tree(ax=ax, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_32_0.png" src="../_images/notebooks_FlowOCT_32_0.png" />
</div>
</div>
</section>
</section>
<section id="Example-2:-Different-Objective-Functions">
<h2>Example 2: Different Objective Functions<a class="headerlink" href="#Example-2:-Different-Objective-Functions" title="Link to this heading">¶</a></h2>
<p>In the following, we have a toy example with an imbalanced data, with the positive class being the minority class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>&#39;&#39;&#39;
    X2
    |               |
    |               |
    1    + - -      |    -
    |               |
    |---------------|--------------
    |               |
    0    - - - +    |    - - -
    |    - - - -    |
    |______0________|_______1_______X1
&#39;&#39;&#39;
X = np.array([[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],
              [1,0],[1,0],[1,0],
              [1,1],
              [0,1],[0,1],[0,1]])
y = np.array([0,0,0,0,0,0,0,1,
              0,0,0,
              0,
              1,0,0])
</pre></div>
</div>
</div>
<section id="Tree-with-classification-accuracy-objective">
<h3>Tree with classification accuracy objective<a class="headerlink" href="#Tree-with-classification-accuracy-objective" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl_acc = FlowOCT(solver=&quot;gurobi&quot;, depth=2, obj_mode=&quot;acc&quot;)
stcl_acc.fit(X, y)
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 60
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 314 rows, 237 columns and 734 nonzeros
Model fingerprint: 0xa5b9a46b
Variable types: 224 continuous, 13 integer (13 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -0.0000000
Presolve removed 269 rows and 203 columns
Presolve time: 0.00s
Presolved: 45 rows, 34 columns, 134 nonzeros
Found heuristic solution: objective 13.0000000
Variable types: 27 continuous, 7 integer (7 binary)

Root relaxation: objective 1.400000e+01, 32 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   14.00000    0    1   13.00000   14.00000  7.69%     -    0s

Cutting planes:
  MIR: 1
  Flow cover: 1

Explored 1 nodes (32 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 8 (of 8 available processors)

Solution count 2: 13 -0

Optimal solution found (tolerance 1.00e-04)
Best objective 1.300000000000e+01, best bound 1.300000000000e+01, gap 0.0000%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FlowOCT(solver=gurobi,depth=2,time_limit=60,num_threads=None,verbose=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>predictions = stcl_acc.predict(X)
print(f&quot;In-sample accuracy is {np.sum(predictions==y)/y.shape[0]}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In-sample accuracy is 0.8666666666666667
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl_acc.print_tree()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#########node  1
leaf 0
#########node  2
pruned
#########node  3
pruned
#########node  4
pruned
#########node  5
pruned
#########node  6
pruned
#########node  7
pruned
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(10, 5))
stcl_acc.plot_tree(ax=ax, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_39_0.png" src="../_images/notebooks_FlowOCT_39_0.png" />
</div>
</div>
</section>
<section id="Tree-with-Balanced-Classification-Accuracy-Objective">
<h3>Tree with Balanced Classification Accuracy Objective<a class="headerlink" href="#Tree-with-Balanced-Classification-Accuracy-Objective" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl_balance = FlowOCT(
    solver=&quot;gurobi&quot;,
    depth=2,
    obj_mode=&quot;balance&quot;,
    _lambda=0,
    verbose=False,
)
stcl_balance.fit(X, y)
predictions = stcl_balance.predict(X)
print(f&quot;In-sample accuracy is {np.sum(predictions==y)/y.shape[0]}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 60
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 314 rows, 237 columns and 734 nonzeros
Model fingerprint: 0x3bc6df12
Variable types: 224 continuous, 13 integer (13 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [4e-02, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -0.0000000
Presolve removed 269 rows and 203 columns
Presolve time: 0.01s
Presolved: 45 rows, 34 columns, 134 nonzeros
Found heuristic solution: objective 0.5000000
Variable types: 27 continuous, 7 integer (7 binary)

Root relaxation: objective 7.500000e-01, 31 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.75000    0    1    0.50000    0.75000  50.0%     -    0s
H    0     0                       0.5288462    0.75000  41.8%     -    0s
H    0     0                       0.6730769    0.75000  11.4%     -    0s
     0     0    0.67308    0    4    0.67308    0.67308  0.00%     -    0s

Cutting planes:
  MIR: 1
  Flow cover: 1

Explored 1 nodes (36 simplex iterations) in 0.01 seconds (0.00 work units)
Thread count was 8 (of 8 available processors)

Solution count 3: 0.673077 0.5 -0
No other solutions better than 0.673077

Optimal solution found (tolerance 1.00e-04)
Best objective 6.730769230769e-01, best bound 6.730769230769e-01, gap 0.0000%
In-sample accuracy is 0.8
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(10, 5))
stcl_balance.plot_tree(ax=ax, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_42_0.png" src="../_images/notebooks_FlowOCT_42_0.png" />
</div>
</div>
<p>As we can see, when we maximize accuracy, i.e., when <code class="docutils literal notranslate"><span class="pre">obj_mode</span> <span class="pre">=</span> <span class="pre">'acc'</span></code>, the optimal tree is just a single node without branching, predicting the majority class for the whole dataset. But when we change the objective mode to balanced accuracy, we account for the minority class by sacrificing the overal accuracy.</p>
</section>
</section>
<section id="Example-3:-UCI-Data-Example">
<h2>Example 3: UCI Data Example<a class="headerlink" href="#Example-3:-UCI-Data-Example" title="Link to this heading">¶</a></h2>
<p>In this section, we fit a tree of depth 3 on a real world dataset called the <code class="docutils literal notranslate"><span class="pre">`balance</span></code> dataset &lt;<a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Balance+Scale">https://archive.ics.uci.edu/ml/datasets/Balance+Scale</a>&gt;`__ from the UCI Machine Learning repository.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import pandas as pd
from sklearn.model_selection import train_test_split
from odtlearn.datasets import balance_scale_data
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># read data
data = balance_scale_data()
print(f&quot;shape{data.shape}&quot;)
data.columns
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
shape(625, 21)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;V2.1&#39;, &#39;V2.2&#39;, &#39;V2.3&#39;, &#39;V2.4&#39;, &#39;V2.5&#39;, &#39;V3.1&#39;, &#39;V3.2&#39;, &#39;V3.3&#39;, &#39;V3.4&#39;,
       &#39;V3.5&#39;, &#39;V4.1&#39;, &#39;V4.2&#39;, &#39;V4.3&#39;, &#39;V4.4&#39;, &#39;V4.5&#39;, &#39;V5.1&#39;, &#39;V5.2&#39;, &#39;V5.3&#39;,
       &#39;V5.4&#39;, &#39;V5.5&#39;, &#39;target&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>y = data.pop(&quot;target&quot;)

X_train, X_test, y_train, y_test = train_test_split(
    data, y, test_size=0.33, random_state=42
)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl = BendersOCT(solver=&quot;gurobi&quot;, depth=3, time_limit=200, obj_mode=&quot;acc&quot;, verbose=True)

stcl.fit(X_train, y_train)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 200
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter LazyConstraints to value 1
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 30 rows, 618 columns and 249 nonzeros
Model fingerprint: 0xaeff5467
Variable types: 463 continuous, 155 integer (155 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Presolve removed 8 rows and 8 columns
Presolve time: 0.00s
Presolved: 22 rows, 610 columns, 233 nonzeros
Variable types: 463 continuous, 147 integer (147 binary)
Root relaxation presolved: 412 rows, 610 columns, 7100 nonzeros

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.00s

Barrier performed 0 iterations in 0.18 seconds (0.00 work units)
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex

Root relaxation: objective 4.180000e+02, 77 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  418.00000    0    4          -  418.00000      -     -    0s
H    0     0                     269.0000000  418.00000  55.4%     -    0s
     0     0  418.00000    0    4  269.00000  418.00000  55.4%     -    0s
     0     2  413.60000    0    9  269.00000  413.60000  53.8%     -    0s
H  308   294                     272.0000000  413.60000  52.1%  75.5    1s
H  483   460                     274.0000000  413.60000  50.9%  75.6    1s
*  533   475              54     290.0000000  413.60000  42.6%  73.6    1s
  1143   887     cutoff   64       290.00000  412.40000  42.2%  78.6    5s
H 1310   970                     291.0000000  412.40000  41.7%  75.5    5s
  1556  1132  316.00000   35   26  291.00000  409.65561  40.8%  70.5   10s
  1629  1180  371.73684   22   25  291.00000  403.03327  38.5%  67.3   15s
  1797  1290  367.57918   36   10  291.00000  402.21668  38.2%  92.8   20s
H 2163  1398                     293.0000000  400.54472  36.7%  92.9   21s
* 2375  1361             111     296.0000000  399.64465  35.0%  91.6   22s
H 3419  1561                     299.0000000  398.14472  33.2%  86.5   24s
  3861  1733  358.57143   67   20  299.00000  398.14472  33.2%  87.2   25s
H 4454  1024                     312.0000000  398.14472  27.6%  85.7   25s
  8785  2721     cutoff   62       312.00000  358.67679  15.0%  82.5   30s
 16715  6109  313.50000   67   16  312.00000  338.60887  8.53%  69.7   35s
H17827  5595                     314.0000000  338.16497  7.70%  67.8   35s
 26793  9027  315.00000   77    8  314.00000  330.38947  5.22%  59.2   40s
H31789  9084                     315.0000000  329.54167  4.62%  57.5   43s
 33926  9710  318.00000   71    8  315.00000  328.75000  4.37%  56.7   45s
H35037  8771                     316.0000000  328.02174  3.80%  56.5   45s
H36500  6760                     318.0000000  327.50000  2.99%  56.0   46s
 42743  6716  322.50000   59   12  318.00000  325.00000  2.20%  54.1   50s
 54532  4635     cutoff   48       318.00000  321.00000  0.94%  50.5   55s
 65931  1611     cutoff   74       318.00000  319.48148  0.47%  47.7   60s

Cutting planes:
  MIR: 120
  Flow cover: 193
  Lazy constraints: 236

Explored 70775 nodes (3292092 simplex iterations) in 61.92 seconds (141.79 work units)
Thread count was 8 (of 8 available processors)

Solution count 10: 318 316 315 ... 290

Optimal solution found (tolerance 1.00e-04)
Best objective 3.180000000000e+02, best bound 3.180000000000e+02, gap 0.0000%

User-callback calls 150674, time in user-callback 1.85 sec
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BendersOCT(solver=gurobi,depth=3,time_limit=200,num_threads=None,verbose=True)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stcl.print_tree()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#########node  1
branch on V3.2
#########node  2
branch on V3.1
#########node  3
branch on V5.1
#########node  4
branch on V2.1
#########node  5
branch on V5.1
#########node  6
branch on V4.1
#########node  7
branch on V2.1
#########node  8
leaf 2
#########node  9
leaf 3
#########node  10
leaf 3
#########node  11
leaf 2
#########node  12
leaf 3
#########node  13
leaf 2
#########node  14
leaf 2
#########node  15
leaf 3
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(20, 10))
stcl.plot_tree(ax=ax, fontsize=20, color_dict={&quot;node&quot;: None, &quot;leaves&quot;: []})
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_50_0.png" src="../_images/notebooks_FlowOCT_50_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>test_pred = stcl.predict(X_test)
print(&#39;The out-of-sample accuracy is {}&#39;.format(np.sum(test_pred==y_test)/y_test.shape[0]))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The out-of-sample accuracy is 0.6859903381642513
</pre></div></div>
</div>
</section>
<section id="Example-4:-User-defined-Weights">
<h2>Example 4: User-defined Weights<a class="headerlink" href="#Example-4:-User-defined-Weights" title="Link to this heading">¶</a></h2>
<p>In this example, we’ll demonstrate how to use user-defined weights with FlowOCT and BendersOCT. We’ll use a small binary classification dataset and show how user-defined weights can affect the learned tree.</p>
<p>First, let’s create our small binary classification dataset:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.random.seed(42)
X = np.random.randint(0, 2, size=(20, 5))
y = np.random.randint(0, 2, size=20)

print(&quot;Dataset shape:&quot;, X.shape)
print(&quot;Class distribution:&quot;, np.bincount(y))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset shape: (20, 5)
Class distribution: [ 6 14]
</pre></div></div>
</div>
<p>Now, let’s create weights that heavily favor class 1:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>weights = np.ones_like(y)
weights[y == 1] = 10

print(&quot;Weight distribution:&quot;)
print(&quot;Class 0:&quot;, weights[y == 0].mean())
print(&quot;Class 1:&quot;, weights[y == 1].mean())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Weight distribution:
Class 0: 1.0
Class 1: 10.0
</pre></div></div>
</div>
<section id="FlowOCT-with-User-defined-Weights">
<h3>FlowOCT with User-defined Weights<a class="headerlink" href="#FlowOCT-with-User-defined-Weights" title="Link to this heading">¶</a></h3>
<p>Let’s fit a FlowOCT model with user-defined weights and compare it to a model without the accuracy objective:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># FlowOCT without custom weights
flow_oct_default = FlowOCT(solver=&quot;gurobi&quot;, obj_mode=&quot;acc&quot;, depth=2, time_limit=10)
flow_oct_default.fit(X, y)

# FlowOCT with custom weights
flow_oct_custom = FlowOCT(solver=&quot;gurobi&quot;, obj_mode=&quot;weighted&quot;, depth=2, time_limit=10)
flow_oct_custom.fit(X, y, weights=weights)

print(&quot;Default FlowOCT predictions:&quot;, flow_oct_default.predict(X))
print(&quot;User-defined weights FlowOCT predictions:&quot;, flow_oct_custom.predict(X))

print(&quot;Default FlowOCT accuracy:&quot;, (flow_oct_default.predict(X) == y).mean())
print(&quot;User-defined weights FlowOCT accuracy:&quot;, (flow_oct_custom.predict(X) == y).mean())
print(&quot;User-defined weights FlowOCT weighted accuracy:&quot;, np.average(flow_oct_custom.predict(X) == y, weights=weights))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 10
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 414 rows, 316 columns and 1153 nonzeros
Model fingerprint: 0x1ad65f5a
Variable types: 294 continuous, 22 integer (22 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -0.0000000
Presolve removed 205 rows and 186 columns
Presolve time: 0.00s
Presolved: 209 rows, 130 columns, 660 nonzeros
Found heuristic solution: objective 14.0000000
Variable types: 112 continuous, 18 integer (18 binary)

Root relaxation: objective 1.966667e+01, 166 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   19.66667    0    7   14.00000   19.66667  40.5%     -    0s
H    0     0                      16.0000000   19.66667  22.9%     -    0s
H    0     0                      17.0000000   19.00000  11.8%     -    0s
     0     0   18.50000    0    9   17.00000   18.50000  8.82%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 6
  RLT: 20

Explored 1 nodes (198 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 8 (of 8 available processors)

Solution count 4: 17 16 14 -0

Optimal solution found (tolerance 1.00e-04)
Best objective 1.700000000000e+01, best bound 1.700000000000e+01, gap 0.0000%
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 10
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 414 rows, 316 columns and 1153 nonzeros
Model fingerprint: 0xf6c20781
Variable types: 294 continuous, 22 integer (22 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -0.0000000
Presolve removed 205 rows and 186 columns
Presolve time: 0.00s
Presolved: 209 rows, 130 columns, 660 nonzeros
Found heuristic solution: objective 140.0000000
Variable types: 112 continuous, 18 integer (18 binary)

Root relaxation: objective 1.456667e+02, 173 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  145.66667    0    7  140.00000  145.66667  4.05%     -    0s
H    0     0                     143.0000000  144.66667  1.17%     -    0s
     0     0  144.00000    0   11  143.00000  144.00000  0.70%     -    0s
     0     0  143.00000    0    6  143.00000  143.00000  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 1
  RLT: 7

Explored 1 nodes (233 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 8 (of 8 available processors)

Solution count 3: 143 140 -0

Optimal solution found (tolerance 1.00e-04)
Best objective 1.430000000000e+02, best bound 1.430000000000e+02, gap 0.0000%
Default FlowOCT predictions: [1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 0]
Custom weights FlowOCT predictions: [1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 0]

Default FlowOCT accuracy: 0.85
Custom weights FlowOCT accuracy: 0.85
Custom weights FlowOCT weighted accuracy: 0.9794520547945206
</pre></div></div>
</div>
<p>Let’s visualize both trees:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span>fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 5))

flow_oct_default.plot_tree(ax=ax1, fontsize=10)
ax1.set_title(&quot;Default FlowOCT&quot;)

flow_oct_custom.plot_tree(ax=ax2, fontsize=10)
ax2.set_title(&quot;User-defined Weights FlowOCT&quot;)

plt.tight_layout()
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_59_0.png" src="../_images/notebooks_FlowOCT_59_0.png" />
</div>
</div>
</section>
<section id="BendersOCT-with-User-defined-Weights">
<h3>BendersOCT with User-defined Weights<a class="headerlink" href="#BendersOCT-with-User-defined-Weights" title="Link to this heading">¶</a></h3>
<p>Now let’s do the same with BendersOCT:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># BendersOCT without custom weights
benders_oct_default = BendersOCT(solver=&quot;gurobi&quot;, obj_mode=&quot;acc&quot;, depth=2, time_limit=10)
benders_oct_default.fit(X, y)

# BendersOCT with custom weights
benders_oct_custom = BendersOCT(solver=&quot;gurobi&quot;, obj_mode=&quot;weighted&quot;, depth=2, time_limit=10, verbose=False)
benders_oct_custom.fit(X, y, weights=weights)

print(&quot;Default BendersOCT predictions:&quot;, benders_oct_default.predict(X))
print(&quot;User-defined weights BendersOCT predictions:&quot;, benders_oct_custom.predict(X))

print(&quot;Default BendersOCT accuracy:&quot;, (benders_oct_default.predict(X) == y).mean())
print(&quot;User-defined weights BendersOCT accuracy:&quot;, (benders_oct_custom.predict(X) == y).mean())
print(&quot;User-defined weights BendersOCT weighted accuracy:&quot;, np.average(benders_oct_custom.predict(X) == y, weights=weights))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 10
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter LazyConstraints to value 1
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 14 rows, 56 columns and 53 nonzeros
Model fingerprint: 0x28902962
Variable types: 34 continuous, 22 integer (22 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Presolve removed 4 rows and 4 columns
Presolve time: 0.00s
Presolved: 10 rows, 52 columns, 45 nonzeros
Variable types: 34 continuous, 18 integer (18 binary)
Root relaxation presolved: 22 rows, 50 columns, 140 nonzeros


Root relaxation: objective 2.000000e+01, 2 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   20.00000    0    -          -   20.00000      -     -    0s
     0     0   20.00000    0    -          -   20.00000      -     -    0s
     0     0   20.00000    0    -          -   20.00000      -     -    0s
     0     0   20.00000    0    7          -   20.00000      -     -    0s
H    0     0                      14.0000000   20.00000  42.9%     -    0s
H    0     0                      16.0000000   20.00000  25.0%     -    0s
     0     0   19.50000    0    2   16.00000   19.50000  21.9%     -    0s
     0     0   19.26563    0    9   16.00000   19.26563  20.4%     -    0s
H    0     0                      17.0000000   19.26563  13.3%     -    0s
     0     0   19.00000    0    8   17.00000   19.00000  11.8%     -    0s
     0     0   18.96429    0    9   17.00000   18.96429  11.6%     -    0s
     0     0   18.95833    0    9   17.00000   18.95833  11.5%     -    0s
     0     0   18.85000    0    9   17.00000   18.85000  10.9%     -    0s
     0     0   18.85000    0    9   17.00000   18.85000  10.9%     -    0s
     0     0   18.76563    0   11   17.00000   18.76563  10.4%     -    0s
     0     0   18.74194    0   10   17.00000   18.74194  10.2%     -    0s
     0     0   18.73913    0    9   17.00000   18.73913  10.2%     -    0s
     0     0   18.59091    0    9   17.00000   18.59091  9.36%     -    0s
     0     0   18.50000    0    9   17.00000   18.50000  8.82%     -    0s
     0     0   18.50000    0    9   17.00000   18.50000  8.82%     -    0s
     0     0   18.37500    0    8   17.00000   18.37500  8.09%     -    0s
     0     0   18.33333    0    8   17.00000   18.33333  7.84%     -    0s
     0     0   18.33333    0    9   17.00000   18.33333  7.84%     -    0s
     0     0   18.31250    0    7   17.00000   18.31250  7.72%     -    0s
     0     0   18.30000    0    7   17.00000   18.30000  7.65%     -    0s
     0     0   18.16667    0    7   17.00000   18.16667  6.86%     -    0s
     0     0   18.14706    0    8   17.00000   18.14706  6.75%     -    0s
     0     0   18.09524    0   10   17.00000   18.09524  6.44%     -    0s
     0     0   18.07059    0   10   17.00000   18.07059  6.30%     -    0s
     0     0   18.03478    0   10   17.00000   18.03478  6.09%     -    0s
     0     0   18.01765    0   11   17.00000   18.01765  5.99%     -    0s
     0     0   18.01333    0   11   17.00000   18.01333  5.96%     -    0s
     0     0   18.00532    0   12   17.00000   18.00532  5.91%     -    0s
     0     0   18.00463    0   12   17.00000   18.00463  5.91%     -    0s
     0     0   17.95833    0    9   17.00000   17.95833  5.64%     -    0s
     0     0   17.91304    0    8   17.00000   17.91304  5.37%     -    0s
     0     0   17.91304    0    8   17.00000   17.91304  5.37%     -    0s
     0     0   17.90909    0    8   17.00000   17.90909  5.35%     -    0s
     0     0   17.90909    0   11   17.00000   17.90909  5.35%     -    0s
     0     0   17.89873    0   11   17.00000   17.89873  5.29%     -    0s
     0     0   17.89873    0   10   17.00000   17.89873  5.29%     -    0s
     0     2   17.89873    0   10   17.00000   17.89873  5.29%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 11
  Flow cover: 5
  Lazy constraints: 46

Explored 16 nodes (312 simplex iterations) in 0.05 seconds (0.02 work units)
Thread count was 8 (of 8 available processors)

Solution count 3: 17 16 14

Optimal solution found (tolerance 1.00e-04)
Best objective 1.700000000000e+01, best bound 1.700000000000e+01, gap 0.0000%

User-callback calls 366, time in user-callback 0.02 sec
Set parameter Username
Academic license - for non-commercial use only - expires 2025-06-28
Set parameter TimeLimit to value 10
Set parameter NodeLimit to value 1073741824
Set parameter SolutionLimit to value 1073741824
Set parameter LazyConstraints to value 1
Set parameter IntFeasTol to value 1e-06
Set parameter Method to value 3
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1 Pro
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 14 rows, 56 columns and 53 nonzeros
Model fingerprint: 0x75b5cba0
Variable types: 34 continuous, 22 integer (22 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Presolve removed 4 rows and 4 columns
Presolve time: 0.00s
Presolved: 10 rows, 52 columns, 45 nonzeros
Variable types: 34 continuous, 18 integer (18 binary)
Root relaxation presolved: 22 rows, 50 columns, 140 nonzeros


Root relaxation: objective 1.460000e+02, 2 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  146.00000    0    -          -  146.00000      -     -    0s
     0     0  146.00000    0    -          -  146.00000      -     -    0s
     0     0  146.00000    0    -          -  146.00000      -     -    0s
     0     0  146.00000    0    7          -  146.00000      -     -    0s
H    0     0                     140.0000000  146.00000  4.29%     -    0s
     0     0  145.50000    0    4  140.00000  145.50000  3.93%     -    0s
     0     0  145.37500    0    7  140.00000  145.37500  3.84%     -    0s
H    0     0                     143.0000000  145.37500  1.66%     -    0s
     0     0  144.88542    0   10  143.00000  144.88542  1.32%     -    0s
     0     0  144.88194    0   10  143.00000  144.88194  1.32%     -    0s
     0     0  144.33333    0    7  143.00000  144.33333  0.93%     -    0s
     0     0  144.30000    0    7  143.00000  144.30000  0.91%     -    0s
     0     0  144.16667    0    7  143.00000  144.16667  0.82%     -    0s
     0     0  144.12500    0    9  143.00000  144.12500  0.79%     -    0s
     0     0  144.12500    0    9  143.00000  144.12500  0.79%     -    0s
     0     0  144.08333    0   11  143.00000  144.08333  0.76%     -    0s
     0     0  144.08036    0   11  143.00000  144.08036  0.76%     -    0s
     0     0  144.08036    0   11  143.00000  144.08036  0.76%     -    0s
     0     0  144.02737    0   10  143.00000  144.02737  0.72%     -    0s
     0     0  144.02737    0   11  143.00000  144.02737  0.72%     -    0s
     0     0  144.02632    0   11  143.00000  144.02632  0.72%     -    0s
     0     0  144.02632    0   10  143.00000  144.02632  0.72%     -    0s
     0     2  144.02632    0    9  143.00000  144.02632  0.72%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 3
  Flow cover: 9
  Lazy constraints: 47

Explored 14 nodes (157 simplex iterations) in 0.03 seconds (0.01 work units)
Thread count was 8 (of 8 available processors)

Solution count 2: 143 140

Optimal solution found (tolerance 1.00e-04)
Best objective 1.430000000000e+02, best bound 1.430000000000e+02, gap 0.0000%
Default BendersOCT predictions: [1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 0]
Custom weights BendersOCT predictions: [1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 0]

Default BendersOCT accuracy: 0.85
Custom weights BendersOCT accuracy: 0.85

User-callback calls 283, time in user-callback 0.01 sec
Custom weights BendersOCT weighted accuracy: 0.9794520547945206
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 5))

benders_oct_default.plot_tree(ax=ax1, fontsize=10)
ax1.set_title(&quot;Default BendersOCT&quot;)

benders_oct_custom.plot_tree(ax=ax2, fontsize=10)
ax2.set_title(&quot;User-defined Weights BendersOCT&quot;)

plt.tight_layout()
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_FlowOCT_62_0.png" src="../_images/notebooks_FlowOCT_62_0.png" />
</div>
</div>
<p>In this example, we’ve demonstrated how to use user-defined weights with both FlowOCT and BendersOCT. By setting <code class="docutils literal notranslate"><span class="pre">obj_mode=&quot;weighted&quot;</span></code> and providing weights during the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method call, we can influence the importance of different samples in the training process. The user-defined weights in this example heavily favor class 1, which may result in trees that are more likely to predict class 1, potentially at the cost of overall accuracy. However, this can be useful in scenarios where
misclassifying one class is more costly than misclassifying the other, or when dealing with imbalanced datasets. Note that the actual results may vary due to the random nature of the dataset and the optimization process. You may want to run the code multiple times or with different random seeds to get a better understanding of the effects of user-defined weights.</p>
</section>
</section>
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Dua, D. and Graff, C. (2019). <a class="reference external" href="http://archive.ics.uci.edu/ml">UCI Machine Learning Repository</a>. Irvine, CA: University of California, School of Information and Computer Science.</p></li>
<li><p>Aghaei, S., Gómez, A., &amp; Vayanos, P. (2021). Strong optimal classification trees. arXiv preprint arXiv:2103.15965. https://arxiv.org/abs/2103.15965.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="FairOCT.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Fair Optimal Classification Trees</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Example Notebooks</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/D3M-Research-Group/odtlearn" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">FlowOCT</span></code> Examples</a><ul>
<li><a class="reference internal" href="#Example-0:-Binarization">Example 0: Binarization</a></li>
<li><a class="reference internal" href="#Example-1:-Varying-depth-and-_lambda">Example 1: Varying <code class="docutils literal notranslate"><span class="pre">depth</span></code> and <code class="docutils literal notranslate"><span class="pre">_lambda</span></code></a><ul>
<li><a class="reference internal" href="#Tree-with-depth-=-1">Tree with <code class="docutils literal notranslate"><span class="pre">depth</span> <span class="pre">=</span> <span class="pre">1</span></code></a></li>
<li><a class="reference internal" href="#Tree-with-depth-=-2">Tree with <code class="docutils literal notranslate"><span class="pre">depth</span> <span class="pre">=</span> <span class="pre">2</span></code></a></li>
<li><a class="reference internal" href="#Tree-with-depth=2-and-Positive-_lambda">Tree with <code class="docutils literal notranslate"><span class="pre">depth=2</span></code> and Positive <code class="docutils literal notranslate"><span class="pre">_lambda</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Example-2:-Different-Objective-Functions">Example 2: Different Objective Functions</a><ul>
<li><a class="reference internal" href="#Tree-with-classification-accuracy-objective">Tree with classification accuracy objective</a></li>
<li><a class="reference internal" href="#Tree-with-Balanced-Classification-Accuracy-Objective">Tree with Balanced Classification Accuracy Objective</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Example-3:-UCI-Data-Example">Example 3: UCI Data Example</a></li>
<li><a class="reference internal" href="#Example-4:-User-defined-Weights">Example 4: User-defined Weights</a><ul>
<li><a class="reference internal" href="#FlowOCT-with-User-defined-Weights">FlowOCT with User-defined Weights</a></li>
<li><a class="reference internal" href="#BendersOCT-with-User-defined-Weights">BendersOCT with User-defined Weights</a></li>
</ul>
</li>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=fe643644"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=4ea706d9"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>